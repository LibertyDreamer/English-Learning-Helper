<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Somebody or Anybody? - Space Text Adventure</title>
  <style>
    /* Old PC / Terminal styling */
    body {
      background-color: black;
      color: #00ff00; /* bright green text */
      font-family: monospace;
      margin: 0;
      padding: 0;
    }
    #container {
      width: 90%;
      max-width: 800px;
      margin: 40px auto;
      padding: 20px;
      border: 2px solid #00ff00;
    }
    h1, h2, h3 {
      color: #00ff00;
      margin: 0 0 10px;
    }
    /* Text-based game styles */
    #game-container {
      margin-bottom: 30px;
    }
    #story {
      white-space: pre-line;
      margin-top: 20px;
      line-height: 1.4;
    }
    .choice-button {
      background-color: black;
      color: #00ff00;
      font-family: monospace;
      border: 1px solid #00ff00;
      padding: 6px 12px;
      margin: 10px;
      cursor: pointer;
    }
    .choice-button:hover {
      background-color: #003300;
    }
    #restart-btn {
      display: none;
      background-color: black;
      color: #00ff00;
      font-family: monospace;
      border: 1px solid #00ff00;
      padding: 6px 12px;
      margin: 20px 0 0 0;
      cursor: pointer;
    }
    #restart-btn:hover {
      background-color: #003300;
    }

    /* Azure OpenAI call area */
    #openai-container {
      border-top: 1px dashed #00ff00;
      padding-top: 20px;
      margin-top: 20px;
    }
    #openai-container input {
      background-color: black;
      color: #00ff00;
      border: 1px solid #00ff00;
      font-family: monospace;
      padding: 5px;
      margin: 5px 0;
      width: 400px;
    }
    #openai-container button {
      background-color: black;
      color: #00ff00;
      font-family: monospace;
      border: 1px solid #00ff00;
      padding: 6px 12px;
      margin: 10px 0;
      cursor: pointer;
    }
    #openai-container button:hover {
      background-color: #003300;
    }
    #result {
      white-space: pre-wrap;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <div id="container">
    <div id="game-container">
      <h1>Somebody or Anybody?</h1>
      <h2>Space Text Adventure</h2>
      <div id="story"></div>
      <div id="choices"></div>
      <button id="restart-btn" onclick="startGame()">Restart Game</button>
    </div>

    <!-- Azure OpenAI Call Section (optional) -->
    <div id="openai-container">
      <h3>Ask Azure OpenAI (Optional)</h3>
      <p>Enter your Azure OpenAI Personal Access Token (PAT) and ask a question.</p>
      <input id="pat" placeholder="Enter your PAT" />
      <br>
      <input id="question" placeholder="Ask something..." />
      <br>
      <button onclick="callOpenAI()">Ask OpenAI</button>
      <pre id="result"></pre>
    </div>
  </div>

  <script>
    /********************************************************
     * PART 1: TEXT-BASED GAME (Somebody vs. Anybody)
     ********************************************************/

    // Scenes for the text-based game
    const scenes = [
      {
        text: 
`You awake in a dimly lit spaceship corridor. 
An ominous voice crackles over the intercom:
"I’m gonna kill ________!"

Do you think the voice said "somebody" or "anybody"?`,
        correctChoice: "somebody",
        onCorrect: `Correct!
He has a specific target in mind. 
You feel a bit safer... maybe it’s not you.`,
        onWrong: `Wrong!
He’ll kill literally anyone—he’s out of control!
You shudder in fear, realizing you might be next...`,
        nextScene: 1,
        altScene: 1
      },
      {
        text:
`You tiptoe deeper into the spaceship. 
Another radio message:
"I can’t find ________ in the cargo bay."

Choose: "somebody" or "anybody"?`,
        correctChoice: "anybody",
        onCorrect: `Nice job!
He doesn't care who specifically—he's just complaining that no one is around.`,
        onWrong: `Uh oh!
He was referring to a specific person, meaning there's a definite target.
Now the confusion grows...`,
        nextScene: 2,
        altScene: 2
      },
      {
        text:
`Suddenly, you see a shadowy figure in front of you. 
He snarls: "I swear, I’m gonna kill ________ right now!"

Choose: "somebody" or "anybody"?`,
        correctChoice: "somebody",
        onCorrect: `Exactly! He has a specific target in mind. 
You dodge aside, hoping it's not you.`,
        onWrong: `Wrong choice.
He’s gone berserk and will kill literally anyone who crosses his path... including you.`,
        nextScene: 3,
        altScene: 3
      },
      {
        text:
`You reach the escape pod. 
The console flickers, asking you for the final passcode: "I’m not going to harm ________."

Which do you enter: "somebody" or "anybody"?`,
        correctChoice: "anybody",
        onCorrect: 
`You got it!
"I’m not going to harm anybody." 
Meaning he won't harm any person at all.
You safely launch away from the spaceship—mission complete!
You've survived and learned the difference between "somebody" and "anybody"!`,
        onWrong: 
`"I’m not going to harm somebody." 
But that implies you might still harm everyone else!
The system rejects your passcode, the shadowy figure corners you...
Game Over!`,
        nextScene: -1,
        altScene: -1
      }
    ];

    let currentScene = 0;

    function startGame() {
      currentScene = 0;
      document.getElementById("restart-btn").style.display = "none";
      showScene();
    }

    function showScene() {
      const scene = scenes[currentScene];
      document.getElementById("story").textContent = scene.text;
      document.getElementById("choices").innerHTML = `
        <button class="choice-button" onclick="choose('somebody')">somebody</button>
        <button class="choice-button" onclick="choose('anybody')">anybody</button>
      `;
    }

    function choose(choice) {
      const scene = scenes[currentScene];
      let resultText = "";

      if (choice === scene.correctChoice) {
        resultText = "\n" + scene.onCorrect;
      } else {
        resultText = "\n" + scene.onWrong;
      }

      const storyElement = document.getElementById("story");
      storyElement.textContent += resultText;

      // Move to next scene
      const next = (choice === scene.correctChoice) ? scene.nextScene : scene.altScene;

      if (next === -1) {
        endGame();
      } else {
        currentScene = next;
        // small delay to mimic old text-based flow
        setTimeout(showScene, 2000);
      }
    }

    function endGame() {
      document.getElementById("choices").innerHTML = "";
      document.getElementById("restart-btn").style.display = "inline-block";
    }

    // Start on load
    window.onload = startGame;

    /********************************************************
     * PART 2: AZURE OPENAI CALL (OPTIONAL)
     ********************************************************/
    async function callOpenAI() {
      const pat = document.getElementById('pat').value.trim();
      const question = document.getElementById('question').value.trim();

      if (!pat) {
        alert("Enter your PAT first!");
        return;
      }
      if (!question) {
        alert("Enter a question!");
        return;
      }

      const endpoint = 'https://models.inference.ai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-02-15-preview';

      try {
        const response = await fetch(endpoint, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': 'Bearer ' + pat,
            'x-ms-model-mesh-model-name': 'gpt-4o'
          },
          body: JSON.stringify({
            messages: [
              { role: 'user', content: question }
            ],
            temperature: 1,
            max_tokens: 4096,
            top_p: 1
          })
        });

        const data = await response.json();
        if (data.choices && data.choices[0].message.content) {
          document.getElementById('result').textContent = data.choices[0].message.content;
        } else {
          document.getElementById('result').textContent = "Error: " + JSON.stringify(data);
        }
      } catch (err) {
        document.getElementById('result').textContent = "Request failed: " + err;
      }
    }
  </script>
</body>
</html>
